<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>
    $(function(){
        // 버튼을 눌렀을때 함수가 실행되면서 get방식의 요청을 한다.
        $('#btnJSON').click(function() {
            $.get(
                // 요청URL은 내부의 json 파일 사용
                './common/02Contact.json',
                // 파라미터는 필요없으므로 생략. 여기서는 형식만 확인하는 용도로 삽입
                {},
                // 콜백함수. 요청에 성공하면 rData로 JSON파일의 내용이 콜백됨
                function(rData, status, xhr){
                    /*
                    매개변수 status, xhr은 사용하지 않으므로 생략가능. 형식만 확인하는 용도로 삽입.
                    */
                    let str= '';
                    /*
                    each()의 두가지 형식
                    1. $(셀렉터).each(콜백함수(index, data){실행부});
                        jQuery의 기본 사용법처럼 셀렉터 뒤에 함수를 호출
                    2. $.each(데이터, 콜백함수(index, data){실행부});
                        셀렉터로 엘리먼트를 선택하는 대신 비동기함수에서 콜백받은 데이터를
                        기반으로 콜백함수를 반복 호출
                    */
                    /* JSON 데이터의 contacts는 배열을 value로 가지고 있으므로
                    요소의 개수만큼 반복할 수 있다 */
                    $.each(rData.contacts, function(index, data){
                        /* index는 0부터 순차적으로 증가하는 값이 전달됨.
                         data는 해당 루프에서 반환되는 요소(객체)가 전달됨 */
                        console.log(index,data);
                        // 각 개체의 key를 통해 데이터 파싱
                        str += '<tr>' 
                            + '<td>'+ data.no + '</td>'
                            + '<td>'+ data.name + '</td>'
                            + '<td>'+ data.tel + '</td>'
                            + '<td><img src="' + data.photo +'"></td>'
                            +'</tr>';
                    });
                    // <table>태그 내부에 추가
                    $('#displayTable').append(str);
                }
            );
        });
    });
    </script>
</head>
<body>
    <h2>$.get() 메서드 사용하기</h2>

    <h3>JSON 파일 읽어오기</h3>
    <button id="btnJSON">JSON데이터 읽어오기</button>
    <table border='1' id="displayTable">
        <tr>
            <td>no</td>
            <td>name</td>
            <td>tel</td>
            <td>photo</td>
        </tr>
    </table>
</body>
</html>